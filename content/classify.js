if (typeof PasswordReuse == "undefined")
  var PasswordReuse = {};

// TODO: Implement some kind of API
var HIGHPROFILE = [ "paypal.com" ];
var PLAINTEXTOFFENDERS = ["emblemhealth.com", "torpedo7.com.au", "careers.petco.com", "questionpro.com", "ramhost.us", "direct.asda.com", "dd-wrt.com", "alumniconnections.com", "theheart.org", "snapfish.nl", "informit.com", "thinktank.ac", "computinghost.com", "bharatmatrimony.com", "sgvsarc.com", "motu.com", "edgar-online.com", "populuslive.com", "tivoli.nl", "citrix.com", "mobilicidade.com.br", "crgadvisors.com", "aldirecruitment.co.uk", "johnlewispartnership.co.uk", "whsmith.co.uk", "netapp.com", "viewoncash.nl", "ladslads.com", "ncees.org", "refworks.com", "dofus.com", "dvd.co.uk", "stompy.com", "tether.com", "depositphotos.com", "alertpay.com", "cameracronies.com", "funtosee.co.uk", "mensa.org", "justbet.cx", "forum.openframeworks.cc", "swimweargalore.com.au", "zennioptical.com", "gotsoccer.com", "aionfreetoplay.com", "pghcareerconnector.com", "payforit.net", "yellowcabpizza.com", "qfs.de", "sole.ph", "finnair.com", "ethicalhacker.net", "collegeadvantage.com", "nmc.org", "familystickers.com", "omgpop.com", "airasia.com", "brainbench.com", "support.ownwebnow.com", "isleofjura.com", "000webhost.com", "cardpatrol.co.uk", "uprinting.com", "studentclearinghouse.org", "mysupermarket.co.il", "anthropologie.com", "thegiantpeach.com", "esds.co.in", "megacloud.it", "vpsland.com", "16-25railcard.co.uk", "eps-software.com", "digitalriver.com", "messenger.claro.com.do", "kurzweilai.net", "givelife.org", "dot.tk", "chamberofchat.com", "nettalk.com", "speckproducts.com", "forcesreunited.org.uk", "spectruminteractive.co.uk", "thebookpond.com", "tel-o-fun.co.il", "drivehq.com", "psncenergy.com", "redcross.org", "simplymoleskine.com", "arkia.co.il", "musicpd.org", "subito.it", "bin32winemerchant.com", "fool.com.au", "dieschmids.at", "sportus.si", "hospitalrecords.com", "ukrhosting.com", "adams.co.uk", "be-at.tv", "snssecure.mcafee.com", "neorouter.com", "mybionicbird.com", "idea.informer.com", "simpleurl.com", "topcashback.co.uk", "bezeqint.net", "www.sdn.nl", "e-whisky.cz", "subway.co.uk", "cancer.org", "tescomobile.com", "htc.com", "dr.com.tr", "livemetallica.com", "relatieplanet.nl", "clickenergy.com.au", "ditech.at", "artscouncil.org.uk", "probikekit.com", "ronniescotts.co.uk", "dancepartner.com", "sapphireselectclub.com", "alcohol-soft.com", "choraline.com", "darntoothysam.com", "adeccousa.com", "beershop.com.br", "convio.com", "gibrick.com", "concertgebouw.nl", "snugglebugz.ca", "notionink.com", "peopleanswers.com", "freeconferencecalling.com", "shop.therme-geinberg.at", "gamecompare.co.uk", "thrustvps.com", "myhosting.com", "livemocha.com", "kalunga.com", "meridiaisland.com", "hug.co.il", "adagio.com", "photo.net", "photolab.ca", "networkforgood.org", "androidswag.com", "hrsmart.com", "thatsmyface.com", "idfa.nl", "joomla.org", "nikeplus.com", "e-germanos.gr", "pathe.nl", "targetjobs.co.uk", "asos.com", "ozon.ru", "netprint.ru", "kuponator.ru", "multiphoto.ru", "sapato.ru", "proboknet.com", "seopult.ru", "121spanish.com", "allrecipes.co.uk", "searchsecurity.com", "sparqcode.com", "groceryiq.com", "electricchoice.com", "maxspann.com", "gametracker.com", "philly.com", "vectorstock.com", "callofduty.com", "freeola.com", "dostavka.ru", "wisepilot.com", "blog.com", "shop.steelseries.com", "donatos.com", "omnias.ru", "superpages.com", "sotmarket.ru", "evga.com", "whitehouse.gov", "isc2education.org", "dotnetnuke.com", "blackjob-spb.org", "cnd.su", "spb.yell.ru", "free-torrents.org", "kinozal.tv", "torrents.net.ua", "hostgator.com", "hertz.com", "freesportsbet.com", "whcms.com", "truphone.com", "pinnaclesys.com", "whatisblik.com", "fotopost24.de", "t-mobile.com", "printerpix.co.uk", "staradvertiser.com", "enzu.com", "micromat.com", "blottr.com", "medscape.com", "thetrainline.com", "comet.co.uk", "olsale.co.il", "escapistmagazine.com", "vizualize.me", "milkround.com", "hyperspin.com", "troopmasterweb.com", "e-academy.com", "dixons.co.uk", "sisleyhonda.com", "companieshouse.gov.uk", "pizzahut.com", "reprisesoftware.com", "israelmall.co.il", "birchbox.com", "hankintailmoitukset.fi", "bizfilings.com", "expresstoll.com", "musictoday.com", "serena.com", "ledlightover.com", "appliedi.net", "deft.com.au", "sam2010.course.com", "victoriassecret.com", "kerpluncgaming.com", "kennards.com.au", "dailymail.co.uk", "24hoursloot.com", "plentyoffish.com", "terminex.com", "jango.com", "yesstyle.com", "sitemeter.com", "blocknews.net", "newgrounds.com", "bt.com", "nspower.ca", "statdiary.info", "redstonehost.com", "canon.com", "angelfire.lycos.com", "lpi.org", "mymathlab.com", "fedex.com", "disney.co.uk", "myanimelist.net", "nascigs.com", "servicedesignnetwerk.nl", "counterculturecoffee.com", "no2id.net", "commonapp.org", "trillian.im", "fugitivetoys.com", "ticketpro.ca", "kizoa.com", "singleswarehouse.co.uk", "post.dk", "jimmyjohns.com", "python.org", "bbcgoodfood.com", "ucas.com", "marvel.com", "nus.org.uk", "famecinemas.com", "pearsoned.com", "politicshome.com", "webstudio.com", "cbcf.org", "gocompare.com", "flatworldknowledge.com", "orange.co.il", "skullcandy.com", "civru.com", "crucial.com", "carling.com", "portal.mypearson.com", "yuplay.ru", "gamazavr.ru", "1dayfly.com", "mpix.com", "softsyshosting.com", "equifax.com", "firstgreatwestern.co.uk", "immobilise.com", "onno.ru", "thesource.ca", "clickandsend.com.au", "match.com", "chesshere.com", "eversave.com", "4shared.com", "campusbookrentals.com", "netflorist.co.za", "1and1.com", "corsair.com", "ancestry.ca", "gk2gk.com", "buylogitech.com", "jobscentral.com.sg", "deloitte.com", "cwcs.co.uk", "mobisms.com", "jetblue.com", "jimdo.com", "telestream.net", "athloncarlease.com", "britishgas.co.uk", "which.co.uk", "monsterindia.com", "huurprofielen.nl", "directwonen.nl", "napster.com", "ticketnet.fr", "ietf.org", "mvpclub.com", "binarycanary.com", "rent.com", "worldwidephotowalk.com", "bittads.com", "fitlinxx.com", "1and1.co.uk", "tek-tips.com", "youlicense.com", "picstop.co.uk", "butlins.com", "referralkey.com", "jobserve.com", "eff.org", "genesreunited.co.uk", "xxlpix.net", "athlinks.com", "ipayx.com", "jcprewards.com", "zpizza.com", "prospects.ac.uk", "pcpitstop.com", "tigerdirect.com", "oldnavy.com", "ft.com", "scholarsresource.com", "bestwestern.com", "huddlein.com", "fon.com", "santanderbillpayment.co.uk", "sacamera.co.za", "midnrreservations.com", "greyhounduk.com", "bunk1.com", "lists.wikimedia.org", "nitroserv.com", "geizhals.at", "rewardrobin.com", "bigpoint.com", "siteuptime.com", "nusextra.co.uk", "oron.com", "spotify-forum.com", "evite.com", "bravenet.com", "mysun.co.uk", "bmw.co.uk", "netacadadvantage.com", "scotsman.com", "tesco.ie", "gameofnerds.com", "pixmania.com", "toshiba.com", "usertesting.com", "10bis.co.il", "chemistry.com", "ebuddy.com", "voyage-prive.co.uk", "tiff.net", "mueller-inc.com", "365chess.com", "store.micgadget.com", "probki.net", "halfordstdfgame.co.uk", "benjerry.intashop.com", "website.ws", "zfco.com", "arclightcinemas.com", "kensington.com", "forum.sysinternals.com", "tracfone.com", "kanobu.ru", "totaljobs.com", "o2.co.uk", "bidvertiser.com", "shoptime.com.ar", "chess.com", "spareroom.co.uk", "timetospa.com", "blueinkmonkey.com", "appsecinc.com", "myprotein.com", "delivery-club.ru", "resellerspanel.com", "hmv.com", "tutsplus.com", "prometric.com", "ekiga.net", "cooksillustrated.com", "proboards.com", "coupons.com", "navigon.com", "clubpenguin.com", "megamek.info", "projectlocker.com", "ipanel.co.il", "imusic.co.il", "48hourslogo.com", "textbroker.com", "eccouncil.org", "sudburyssc.com", "surveyspot.com", "rmi.org", "hobbyking.com", "twintecinc.com", "doodle.com", "velo-antwerpen.be", "meetingwizard.com", "1-day.co.nz", "siriusxm.com", "gchq.gov.uk", "escapistmag.com", "samsungmobile.com", "chessclub.com", "gamestracker.com", "lug.org.uk", "asuswebstorage.com", "z8games.com", "direct2drive.com", "forum.ixbt.com", "rabota33.ru", "vpsville.ca", "mozillalabs.com", "savagehearts.co.uk", "gnc.com", "star.me", "planetcostume.com", "enom.com", "friendster.com", "deniath.com", "tinhouse.com", "oovoo.com", "neopets.com", "friendsreunited.co.uk", "ccbill.com", "dealextreme.com", "narrativemagazine.com", "financial-planning.com", "jerrydoyle.com", "winxclub.com", "mymealtime.com", "telltalegames.com", "nixcom.ca", "boomshoes.de", "wg-gesucht.de", "smashingmagazine.com", "trueachievements.com", "blacknight.com", "datingbuzz.co.uk", "newegg.com", "nd.ru", "macys.com", "parkmobile.com", "beerandbeyond.com", "guardian.co.uk", "dietitians.ca", "zipzoom.com", "tweetbig.com", "just-eat.co.uk", "mediapost.com", "tokyoflash.com", "pss-piter.org", "askmen.com", "digitec.ch", "burningshed.com", "veoliaes.com", "pringoo.com", "nextiva.com", "maxemail.com", "registry.gimp.org", "turnitin.com", "eppe.nu", "discover.com", "virginmobile.co.uk", "surveymonkey.com", "superjob.ru", "goldenshara.com", "motorussia.ru", "cifracom.ru", "003.ru", "muellerspasta.com", "takeaway.com", "chicagooperatheater.org", "asiaxpat.com", "santrex.net", "tadalist.com", "gumtree.com", "dreamstime.com", "www.dreamstime.com", "yesasia.com", "nature.com", "crrrrazyboris.proboards.com", "strongvpn.com", "flyordie.com", "software.intel.com", "wiso.buhl.de", "my.ukrtelecom.ua", "mobile-downloads.ru", "rutracker.org", "rutube.ru", "wituclub.ru", "photofile.ru", "sql-ex.ru", "uml2.ru", "barahla.net", "springerlink.com", "online.net", "easychair.org", "volga34.ru", "aretta.com", "ualberta.ca", "pingdom.com", "rbsworldpay.com", "easydns.com", "rzd.ru", "nanog.org", "nintendo-europe.com", "stardock.net", "aplus.net", "giyus-isky.co.il", "coroflot.com", "netfirms.com", "talawa.fr", "myspace.com", "oen.net", "ere.net", "naurunappula.com", "portableone.com", "discovercard.com", "ashleymadison.com", "yak.ca", "dealnews.com", "thepiratebay.com", "www.wg-gesucht.de", "hover.com", "tesco.co.uk", "reliancecomfort.com", "firstcapitalconnect.co.uk", "t-mobile.net", "domainsatcost.ca", "virginmobile.com", "starcitygames.com", "papajohs.co.uk", "dreamhost.com", "codeweavers.com", "asda.com", "msdn.e-academy.com", "jinni.com", "www.rep-am.com", "mindbodyonline.com", "crossfitoakland.com", "gameforge.com", "webserve.ca", "super-seed.me.uk", "newyorker.com", "justgiving.com", "codespeak.net", "hemnet.se", "comunio.es", "plataforma10.com", "eline.co.il", "ejobs.ro", "hadran.co.il", "ourgroceries.com", "fatsecret.com", "buy2.co.il", "rapidshare.com", "apress.com", "pelephone.co.il", "endomondo.com", "hyperiums.com", "holmesplace.co.il", "zer4u.co.il", "hometheater.co.il", "yad2.co.il"];

PasswordReuse.Classify = {
  MIXED: -1,
  PLAINTEXT: 0,   // Sites storing your password in plain text
  OTHER: 1,       // everything else
  SECURE: 2,      // everything https://
  HIGHPROFILE: 3, // Banking, PayPal

  classifyDomain: function(domain)
  {
    var secure;

    if (domain.match(/^https:\/\//))
    {
      secure = true;
      domain = domain.substr(8, domain.length - 8);
    }
    else if (domain.match(/^http:\/\//))
    {
      secure = false;
      domain = domain.substr(7, domain.length - 7);
    }

    if (PLAINTEXTOFFENDERS.indexOf(domain) != -1)
      return this.PLAINTEXT;
    if (HIGHPROFILE.indexOf(domain) != -1)
      return this.HIGHPROFILE;
    return secure ? this.SECURE : this.OTHER;
  },

  getDescription: function(domainClass)
  {
    var descriptions = ["Mixed", "Plain Text Offender", "Normal", "Secure", "High Profile"];
    return descriptions[domainClass + 1];
  }
};
